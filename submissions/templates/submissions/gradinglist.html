{% extends 'submissions/exercises.html' %}

{% load bootstrap4 %}

{% load django_bootstrap_breadcrumbs %}
{% block breadcrumbs %}
  {{ block.super }}
  {% breadcrumb "Omat arvosteltavat" "submissions:grading" exercise_id %}
{% endblock %}

{% block content %}

  <div class="col-md-6">
    <h1> Omat arvosteltavat </h1>

    {% if gradinglist %}
      <ul class="list-group">
        {% for sub in gradinglist %}
        
          <li class="list-group-item">
          
            <a href="{%url 'submissions:feedback' sub.exercise.exercise_id sub.sub_id %}">
              {{ sub }}
            </a>
            
            
            {% for student in sub.students.all %}
              {{ student }}
            {% endfor %}
            
            
            {% if sub.status == sub.READY %}
              <div class="alert alert-warning" role="alert">
                VALMIS
              </div>
            {% elif sub.status == sub.DRAFT %}
              <div class="alert alert-danger" role="alert">
                LUONNOS
              </div>
            {% elif sub.released %}
              <div class="alert alert-success" role="alert">
                JULKAISTU
              </div>
            {% endif %}
            
            
          </li>
          
        {% endfor %}
      </ul>
      
      
      <a class="btn btn-primary" href="{% url 'submissions:release' exercise_id %}" role="button">
      Julkaise arvostelut
      </a>
      
      
      {% else %}
        <div class="alert alert-info" role="alert">
          Ei arvosteltavia palautuksia.
        </div>
    {% endif %}
    
  </div> <!-- column -->


  <div class="col-md-6">


<!--
    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#submissions_all">
      Näytä kaikki palautukset
    </button>


    <div class="collapse mt-4" id="submissions_all">
-->

    <h1> Palautukset joilla ei vielä ole arvostelijaa </h1>
    {% if formset.forms %}
      <form method="post" action="{% url 'submissions:set_grader' exercise_id %}">
        {% csrf_token %}
        {{ formset.management_form }}
        {% for form in formset %}
          <div class="form-group">
            {{ form.id }}
            {{ form.instance.sub_id }}
            {% for student in form.instance.students.all %}
              {{ student }}
            {% endfor %}
            {{ form.check_this }}
          </div>
        {% endfor %}
        <button type="submit" class="btn btn-primary">Lisää omalle listalle</button>
      </form>
    {% else %}
      <div class="alert alert-info" role="alert">
        Ei palautuksia.
      </div>
    {% endif %}


   <!-- </div> collapse -->
  </div> <!-- column -->

{% endblock %}
